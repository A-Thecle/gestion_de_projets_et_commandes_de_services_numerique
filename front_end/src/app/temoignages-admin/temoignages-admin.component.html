<div *ngIf="loading">Chargement des témoignages...</div>

<div class="temoignages-cards" *ngIf="!loading">
  <div class="temoignage-card" *ngFor="let temoignage of filteredTemoignages">
    <div class="card-header">
      <span class="temoignage-id">Témoignage #{{ temoignage.id_temoignage }}</span>
      <span class="statut">{{ temoignage.statut_temoignage }}</span>
    </div>
    
    <div class="card-body">
      <p><strong>Client:</strong> {{ temoignage.client?.nom }} {{ temoignage.client?.prenom }} ({{ temoignage.client?.email || 'N/A' }})</p>
      <p><strong>Projet:</strong> {{ temoignage.projet?.titre_projet}}{{temoignage.id_projet }}</p>
      <p><strong>Projet (ID):</strong> {{ temoignage.id_projet }}</p>
      <p><strong>Note:</strong> {{ temoignage.note }} / 5</p>
      <p><strong>Commentaire:</strong> {{ temoignage.commentaire }}</p>
      <p><strong>Date:</strong> {{ temoignage.date_soumission | date:'dd/MM/yyyy HH:mm' }}</p>
    </div>
    
<div class="card-footer">
  <button class="btn-valider" (click)="confirmAction(temoignage.id_temoignage!, 'publier')">Publier</button>
  <button class="btn-refuser" (click)="confirmAction(temoignage.id_temoignage!, 'refuser')" >Refuser</button>
</div>


  </div>

<!-- Modal de confirmation -->
<div class="confirmation-modal" *ngIf="showConfirmModal">
  <div class="modal-content">
    <h3>
      Voulez-vous vraiment
      {{ currentAction === 'publier' ? 'publier' : 'refuser' }}
      ce témoignage ?
    </h3>
    <div class="modal-actions">
      <button (click)="executeAction()">Oui</button>
      <button (click)="showConfirmModal = false" style="color: red;">Non</button>
    </div>
  </div>
</div>

<!-- Modal de succès -->
<div class="confirmation-modal" *ngIf="showSuccessModal">
  <div class="modal-content">
    <h3>{{ successMessage }}</h3>
    <button (click)="closeSuccessModal()">OK</button>
  </div>
</div>



  <!-- Pagination -->
  <div class="pagination">
    <button (click)="prevPage()" [disabled]="currentPage === 1">Précédent</button>
    <span>Page {{currentPage}} / {{totalPages}}</span>
    <button (click)="nextPage()" [disabled]="currentPage === totalPages">Suivant</button>
  </div>
</div>

<p *ngIf="message" class="message">{{ message }}</p>